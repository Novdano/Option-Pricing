}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
init_price <- 186.87
K <- 195
r<- 0.018
sigma <- 0.2158482
T <- 1
M <- 100
N <- 100
init_price <- 186.87
K <- 195
r<- 0.018
sigma <- 0.2158482
T <- 1
M <- 100
N <- 100
init_price <- 186.87
K <- 195
r<- 0.018
sigma <- 0.2158482
T <- 1
M <- 100
N <- 100
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
init_price <- 186.87
K <- 195
r<- 0.018
sigma <- 0.2158482
T <- 1
M <- 1000
N <- 1000
init_price <- 186.87
K <- 195
r<- 0.018
sigma <- 0.2158482
T <- 1
M <- 1000
N <- 1000
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
init_price <- 186.87
K <- 195
r<- 0.018
#sigma <- 0.2158482
sigma <- 0.24526
T <- 1
M <- 1000
N <- 1000
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
MC <- rep(0,20)
BS <- rep(0,20)
SV1 <- rep(0,20)
SV2 <- rep(0,20)
SV3 <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV1[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 1, 0.02, 0.01 ,-0, T, M, N)
SV2[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 5, 0.02, 0.01 ,-0, T, M, N)
SV3[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.02, 0.01,-0, T, M, N)
}
init_price <- 50
K <- 30
r<- 0.05
sigma <- 0.02
T <- 5
M <- 100
N <- 100
MC <- rep(0,20)
BS <- rep(0,20)
SV1 <- rep(0,20)
SV2 <- rep(0,20)
SV3 <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV1[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 1, 0.02, 0.05 ,-0, T, M, N)
SV2[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 5, 0.02, 0.05 ,-0, T, M, N)
SV3[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.02, 0.05,-0, T, M, N)
}
plot(c(31:70), MC, main = "k = 1, 5, 10", ylab = "Price", xlab="Strike", type = "l", col = "blue")
lines(31:70, BS, col = "red")
lines(31:70, SV1, col = "green")
lines(31:70, SV2, col = "pink")
lines(31:70, SV3, col = "black")
legend("topright",
c("MonteCarlo","BlackScholes", "SV1", "SV2","SV3"),
fill=c("blue","red", "green", "pink", "black"))
MC <- rep(0,20)
BS <- rep(0,20)
SV1 <- rep(0,20)
SV2 <- rep(0,20)
SV3 <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV1[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1, 0.02, 0.05 ,-0, T, M, N)
SV2[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.05 ,-0, T, M, N)
SV3[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 1, 0.02, 0.05,-0, T, M, N)
}
MC <- rep(0,20)
BS <- rep(0,20)
SV1 <- rep(0,20)
SV2 <- rep(0,20)
SV3 <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV1[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1, 0.02, 0.005 ,-0, T, M, N)
SV2[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.005 ,-0, T, M, N)
SV3[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 1, 0.02, 0.005,-0, T, M, N)
}
plot(c(31:70), MC, main = "k = 1, 5, 10", ylab = "Price", xlab="Strike", type = "l", col = "blue")
lines(31:70, BS, col = "red")
lines(31:70, SV1, col = "green")
lines(31:70, SV2, col = "pink")
lines(31:70, SV3, col = "black")
legend("topright",
c("MonteCarlo","BlackScholes", "SV1", "SV2","SV3"),
fill=c("blue","red", "green", "pink", "black"))
MC <- rep(0,20)
BS <- rep(0,20)
SV1 <- rep(0,20)
SV2 <- rep(0,20)
SV3 <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV1[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1, 0.02, 0.005 ,-0, T, M, N)
SV2[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.005 ,-0, T, M, N)
SV3[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 1, 0.02, 0.005,-0, T, M, N)
}
plot(c(31:70), MC, main = "kappa = 1, 5, 10", ylab = "Price", xlab="Strike", type = "l", col = "blue")
lines(31:70, BS, col = "red")
lines(31:70, SV1, col = "green")
lines(31:70, SV2, col = "pink")
lines(31:70, SV3, col = "black")
legend("topright",
c("MonteCarlo","BlackScholes", "SV1", "SV2","SV3"),
fill=c("blue","red", "green", "pink", "black"))
#knitr::opts_chunk$set(echo = TRUE)
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
BS_V0 <- function(S_0, K, r, sigma, T){
d1 <- (log(S_0/K) + (r + sigma^2/2)*T)/(sigma * sqrt(T))
d2 <- (log(S_0/K) + (r - sigma^2/2)*T)/(sigma * sqrt(T))
res <- S_0 * pnorm(d1) - K*pnorm(d2) * exp(-r * T)
return(res)
}
MC_V0 <- function(S_0, K, r, sigma, T, N, M){
payoff <- rep(0,M)
for (i in 1:M){
s <- S_0
for (n in 1:N){
s <- s + r*s*(T/N) + sigma * s * rnorm(1) * sqrt(T/N)
}
if (s>K){
payoff[[i]] <- s-K
} else {
payoff[[i]] <- 0
}
}
res <- (1 + r * (T/N))^-N * mean(payoff)
}
MC<-MC_V0(init_price, K, r, sigma, T, M, N)
BS<-BS_V0(init_price, K, r, sigma, T)
MC
BS
MC <- rep(0,20)
BS <- rep(0,20)
for (i in 1:20){
MC[[i]] <- MC_V0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
}
print(MC)
print(BS)
plot(c(50:69), MC, main = "plot K = 50,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue")
lines(50:69, BS, col = "red")
legend("topleft",
c("MonteCarlo","BlackScholes"),
fill=c("blue","red"))
print("123", 1)
print("123", "1")
print("123")print(1)
print("123")print(1)
print("123")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_chunk$set(echo = TRUE)
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.004, 0.05 ,-0.8, T, M, N)
#SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1 , 0.02, 0.00 ,-0, T, M, N)
#SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 50,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
#lines(21:40, SV_20k, col = "pink")
#lines(21:40, SV_30k, col = "black")
legend("topleft",
c("MonteCarlo","BlackScholes", "SV"),
fill=c("blue","red", "green"))
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.004, 0.05 ,-0.8, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 30,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
lines(21:40, SV_20k, col = "pink")
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.004, 0.05 ,-0.8, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 30,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
lines(21:40, SV_20k, col = "pink")
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.004, 0.05 ,-0.8, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 30,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
lines(31:70, SV_20k, col = "pink")
lines(31:70, SV_30k, col = "black")
legend("topleft",
c("MonteCarlo","BlackScholes", "SV1", "SV2", "SV3"),
fill=c("blue","red", "green", "pink", "black"))
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.02, 0.05 ,-0.0, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 30,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
lines(31:70, SV_20k, col = "pink")
lines(31:70, SV_30k, col = "black")
legend("topleft",
c("MonteCarlo","BlackScholes", "SV1", "SV2", "SV3"),
fill=c("blue","red", "green", "pink", "black"))
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1, 0.02, 0.05 ,-0.0, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.02, 0.00 ,-0, T, M, N)
}
MC <- rep(0,20)
BS <- rep(0,20)
SV_10k <- rep(0,20)
SV_20k <- rep(0,20)
SV_30k <- rep(0,20)
for (i in 1:40){
MC[[i]] <- MC_BSV0(init_price, K+i, r, sigma, T, M, N)
BS[[i]] <- BS_V0(init_price, K+i, r, sigma, T)
SV_10k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.1, 0.02, 0.00 ,-0.0, T, M, N)
SV_20k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 0.5 , 0.02, 0.00 ,-0, T, M, N)
SV_30k[[i]] <- MC_SV0(init_price, K+i, r, sigma^2, 10, 0.02, 0.00 ,-0, T, M, N)
}
plot(c(31:70), MC, main = "plot K = 30,...,70", ylab = "Price", xlab="Strike", type = "l", col = "blue", ylim=c(0,40))
lines(31:70, BS, col = "red")
lines(31:70, SV_10k, col = "green")
lines(31:70, SV_20k, col = "pink")
lines(31:70, SV_30k, col = "black")
legend("topleft",
c("MonteCarlo","BlackScholes", "SV1", "SV2", "SV3"),
fill=c("blue","red", "green", "pink", "black"))
