oldk <- 0.3
oldt <- 0.2
newk <- 0.3
newt<- 0.2
deltaK <- 0.01
deltaT <- 0.01
new_vecs<-c(2,1)
while (deltaK>0.0001 && deltaT > 0.0001){
print(newk)
print(newt)
oldk<-newk
oldt<-newt
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- grid_search(oldk, oldt, deltaK, deltaT)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
deltaK <- new_vecs[[3]]
deltaT <- new_vecs[[4]]
print(deltaK)
print(deltaT)
}
print(newk)
print(newt)
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-4){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.01, 0.01,0.001,0.01)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
print(MSE(old_vecs,new_vecs)>1e-4)
}
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-4){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.01, 0.01,0.001,0.01, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
print(MSE(old_vecs,new_vecs)>1e-4)
}
print(newk)
print(newt)
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-4){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.01, 0.01,0.001,0.01, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
print(MSE(old_vecs,new_vecs))
}
print(newk)
print(newt)
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-8){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.01, 0.01,0.001,0.01, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
print(MSE(old_vecs,new_vecs))
}
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-5){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.1, 0.1,0.01,0.1, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
print(MSE(old_vecs,new_vecs))
}
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-5){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.1, 0.1,0.01,0.1, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
#print(MSE(old_vecs,new_vecs))
}
print(newk)
print(newt)
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-5){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.1, 0.1,0.01,0.1, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
#print(MSE(old_vecs,new_vecs))
}
print(MSE(old_vecs,new_vecs))
print(newk)
print(newt)
print(newm)
print(newr)
oldk <- 0.3
oldt <- 0.2
newk <- 0.3
newt<- 0.2
deltaK <- 0.01
deltaT <- 0.01
new_vecs<-c(2,1)
while (deltaK>0.0001 && deltaT > 0.0001){
print(newk)
print(newt)
oldk<-newk
oldt<-newt
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- grid_search(oldk, oldt, deltaK, deltaT)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
deltaK <- new_vecs[[3]]
deltaT <- new_vecs[[4]]
print(deltaK)
print(deltaT)
}
oldk <- 0.3
oldt <- 0.2
newk <- 0.3
newt<- 0.2
deltaK <- 0.01
deltaT <- 0.01
new_vecs<-c(2,1)
while (deltaK>0.0001 && deltaT > 0.0001){
print(newk)
print(newt)
oldk<-newk
oldt<-newt
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- grid_search(oldk, oldt, deltaK, deltaT)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
deltaK <- new_vecs[[3]]
deltaT <- new_vecs[[4]]
}
oldk <- 0.3
oldt <- 0.2
newk <- 0.3
newt<- 0.2
deltaK <- 0.01
deltaT <- 0.01
new_vecs<-c(2,1)
while (deltaK>0.0001 && deltaT > 0.0001){
oldk<-newk
oldt<-newt
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- grid_search(oldk, oldt, deltaK, deltaT)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
deltaK <- new_vecs[[3]]
deltaT <- new_vecs[[4]]
}
print(newk)
print(newt)
kappa <- 0.1
theta <- 0.2
rho <- -0.2
miu <- 0.001
deltas <- seq(0, 0.4,0.0001)
gradient <- rep(0,length(deltas))
for (i in 1:length(deltas)){
gradient[[i]] <- (short_opt(c(kappa + deltas[[i]], theta, miu, rho)) - short_opt(c(kappa - deltas[[i]], theta, miu, rho)))/2*deltas[[i]]
}
plot(deltas, gradient)
oldk <- 0.3
oldt <- 0.2
oldm <- 0.001
oldr <- -0.2
newk <- 0.3
newt <- 0.2
newm <- 0.001
newr <- -0.2
old_vecs<-c(1,1,1,1)
new_vecs<-c(99,99,99,99)
while (MSE(old_vecs,new_vecs)>1e-5){
oldk<-newk
oldt<-newt
oldm <- newm
oldr <- newr
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- SGD(oldk, oldt,oldm,oldr, 0.01, 0.01,0.01,0.01, 0.1)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
newm <- new_vecs[[3]]
newr <- new_vecs[[4]]
#print(MSE(old_vecs,new_vecs))
}
oldk <- 0.5
oldt <- 0.7
newk <- 0.5
newt<- 0.7
deltaK <- 0.01
deltaT <- 0.01
new_vecs<-c(2,1)
while (deltaK>0.0001 && deltaT > 0.0001){
oldk<-newk
oldt<-newt
old_vecs <- c(oldk, oldt, oldm, oldr)
new_vecs <- grid_search(oldk, oldt, deltaK, deltaT)
newk<- new_vecs[[1]]
newt <- new_vecs[[2]]
deltaK <- new_vecs[[3]]
deltaT <- new_vecs[[4]]
}
print(newk)
print(newt)
pnorm(1)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(e^(-r*(T-n*(T/N))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.2,1,-0.4,0.2,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp(-r*(T-n*(T/N))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.2,1,-0.4,0.2,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.2,1,-0.4,0.9,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,25,0.2,1,-0.4,0.9,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,25,0.2,1,-0.4,0.9,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,25,1,-0.4,0.9,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.4,1,-0.4,0.4,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
if (S>K){
payoff <- payoff + S-K
}
print(payoff)
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.4,0.9,0.3,0.4,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
}
print(S)
if (S>K){
payoff <- payoff + S-K
}
print(payoff)
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.4,0.9,0.3,0.4,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- pnorm(1)
W2 <- pnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
print(S)
}
if (S>K){
payoff <- payoff + S-K
}
print(payoff)
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.4,0.9,0.3,0.4,1,100,100)
SABR_MC_Call <- function(S_0, K, r, alpha_0, beta, rho, nu, T, M, N){
payoff <- 0
for(i in 1:M){
S <- S_0
alpha <- alpha_0
for(n in 1:N){
W1 <- rnorm(1)
W2 <- rnorm(1)
S <- S + r*S*(T/N) + alpha*S^beta*sqrt(T/N)*W1*(exp((-r*(T-n*(T/N)))))^(1-beta)
alpha <- alpha + nu*alpha*(rho * W1 + sqrt(1-rho^2)*W2)*sqrt(T/N)
print(S)
}
if (S>K){
payoff <- payoff + S-K
}
print(payoff)
}
return ((payoff/M) * (1+r*(T/N))^-N)
}
SABR_MC_Call(50,50,0.02,0.4,0.9,0.3,0.4,1,100,100)
